function RR=get_RR(senz,ws)
% xiaolong yu, xiamen univeristy
% revision history:
% created on Feb 2, 2021
% 
%% input
% senz: viewing zenith angle, deg
% ws: wind speed, m/s

% output
% RR : reflection–refraction term (see Morel & Gentili, 1996, AO)
      
%     RR=(1-rho1)*(1-rho2)/(1-r*Rw)/n^2;     % reflection–refraction term, Morel et al.(2002)
%     RR is derived from the LUT as in Fig. 11 of Morel et al., 2002
      % rho1: the air–water Fresnel reflection at the interface for the 
%             whole Sun & sky downwelling irradiance (4% ~ 5%), taken as 0.043 (Gordon, 1988)  
      % rho2: Fresnel downward reflection at the interface. heavily depends on wind speed, weakly on solz.
      % r: water–air Fresnel reflection for the whole diffuse upwelling
      %     irradiance =0.489  Morel et al.(2002)
      % Rw: irradiance reflectance ratio beneath the surface, typically < 0.1
      % 1-r*Rw: set to 0.985, with 3% error when Rw = 0% ~ 6%       
      
      
senz0=0:2.5:87.5;
ws0=[0,4,10,16];
[X1,Y1]=meshgrid(senz0,ws0);

% LUT (for senz=0-60 deg) is extracted from Fig 11 of Morel & Gentili (1996) using WebPlotDigitizer (https://automeris.io/WebPlotDigitizer/)
% LUT is later extended to senz = 62.5-87.5 deg using Matlab interp1('pchip'&'extrap')

% LUT=[0.5291	0.529099839	0.529100773	0.529097262	0.5291	0.528994114	0.528963432	0.528813327	0.5288	0.528686742	0.52872416	0.528538282	0.5285	0.5283	0.5279	0.5275	0.527	0.5263	0.5253	0.5239	0.5221	0.5192	0.516	0.5119	0.5076	0.503104762	0.498428571	0.493585714	0.488590476	0.483457143	0.4782	0.472833333	0.467371429	0.461828571	0.456219048	0.450557143
% 0.5291	0.5288	0.5287	0.5288	0.5289	0.5289	0.5289	0.5289	0.5288	0.52881675	0.528662832	0.528350754	0.528	0.5276	0.5268	0.5258	0.5244	0.5228	0.52	0.5161	0.5087	0.4983	0.4847	0.4694	0.4535	0.437011538	0.419969231	0.402407692	0.384361538	0.365865385	0.346953846	0.327661538	0.308023077	0.288073077	0.267846154	0.247376923
% 0.5287	0.5288	0.5288	0.5289	0.5289	0.5287	0.5289	0.5286	0.5284	0.528028529	0.527586646	0.52672311	0.5255	0.5239	0.5214	0.5177	0.513	0.5063	0.4979	0.4873	0.4756	0.4608	0.4447	0.4271	0.4088	0.389813649	0.370181894	0.349945682	0.329145961	0.307823677	0.286019777	0.263775209	0.241130919	0.218127855	0.194806964	0.171209192
% 0.5287	0.5288	0.5287	0.5287	0.5287	0.5288	0.5283	0.5278	0.5271	0.526061128	0.524468913	0.52210076	0.5194	0.515182548	0.510323929	0.503537095	0.4959	0.486875844	0.476656818	0.464565776	0.451	0.436848246	0.421702407	0.405377103	0.389	0.37257118	0.356090889	0.339559374	0.32297688	0.306343654	0.289659941	0.272925988	0.256142042	0.239308347	0.222425151	0.205492699];
%% Gordon 2005 Fig. 5
LUT=[0.52879	0.52877	0.52878	0.52879	0.5288	0.52881	0.52875	0.52874	0.52859	0.52859	0.52855	0.52807	0.52795	0.52767	0.52755	0.52723	0.52668	0.52594	0.5247	0.52331	0.52148	0.51901	0.51649	0.51264	0.5075	0.50003	0.49197	0.48063	0.46624	0.44606	0.42157	0.39501	0.36883	0.34271	0.31659	0.29047
0.52879	0.52877	0.52878	0.52879	0.5288	0.52872	0.52864	0.52868	0.52883	0.52879	0.52835	0.52801	0.528	0.52769	0.52757	0.52719	0.52655	0.52529	0.52399	0.52248	0.52018	0.51779	0.51503	0.51064	0.50503	0.49788	0.48983	0.47903	0.46497	0.44726	0.42765	0.40462	0.38147	0.35838	0.3353	0.31222
0.52879	0.52881	0.52894	0.52903	0.52898	0.52905	0.52893	0.52882	0.52874	0.52877	0.52853	0.52838	0.52815	0.52788	0.52759	0.52658	0.52586	0.52462	0.5229	0.52117	0.51876	0.51596	0.51283	0.50856	0.50342	0.4961	0.48854	0.47981	0.46816	0.45591	0.44234	0.4265	0.41088	0.39572	0.38031	0.36489
0.52879	0.52889	0.52875	0.52879	0.52875	0.52881	0.52878	0.52881	0.52867	0.52872	0.52836	0.52807	0.52786	0.5275	0.52668	0.52583	0.52491	0.52369	0.52204	0.52007	0.51788	0.51471	0.51107	0.50677	0.50145	0.4956	0.4891	0.48156	0.47253	0.46301	0.45204	0.44121	0.42885	0.41677	0.40429	0.392];


[Xq,Yq]=meshgrid(senz,ws); % input 
RR=interp2(X1,Y1,LUT,Xq,Yq,'spline');

end
